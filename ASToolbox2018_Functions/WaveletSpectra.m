function spectra = WaveletSpectra(mat,dt,dj,low_period,up_period,pad,...                                   mother,beta,gamma)%Wavelet spectra of columns of a given  matrix%% spectra=WaveletSpectra(mat,dt,dj,lowPeriod,up_period,pad,...%                                  mother,beta,gamma)%  Computes all the wavelet spectra (i.e. Wavelet Transforms) of several %  series (columns of a matrix) mat. The wavelet transforms can be computed%  with Morlet or Generaized Morse Wavelets.  It makes use of function AWT.% %   INPUT:%       mat - a matrix (columns are the series whose Wavelet Transforms%                we want to compute).%             %       dt - sampling rate %            0  or []-> Default: dt = 1%       dj - frequency resolution (1/dj = number of voices per octave)%            0  or [] -> Default: dj = 1/4%       low_period - lower period of the decomposition %            0 or [] -> Default: lowPeriod = 2*dt%       up_period - upper period of the decomposition %             0 or []-> Default: upPeriod = length(x)*dt      %       pad - the type of pad to the series (boundary conditions):%             0 or 'zero' or [] -> zero-pading (default)%             1 or 'reflexive' -> reflection at the boundaries%             2 or 'constant' -> constant (repeat first and last values)%       mother - the type of mother wavelet function: %               0 or 'Morlet' or [] -> Morlet wavelet (default)%               1 or  'GMW'   -> Generalized Morse Wavelet    %       beta - the beta parameter for the GMW or the Morlet (w0) parameter:%             0  or []-> Default: 6.0 for 'Morlet'; 3.0 for 'GMW'                                                      %       gamma - the gamma parameter of the GMW %             0 or [] ->  Default: 3.0 %   OUTPUT:%       spectra - row-cell containing all the computed spectra.%       % See also: AWT% Copyright 2010, L. Aguiar-Conraria and M.J. Soares%%%   Luís AGUIAR-CONRARIA              Maria Joana SOARES                      %   Dep. Economics                    Dep. Mathematics and Applications   %   University of Minho               University of Minho%   4710-057 Braga                    4710-057 Braga%   PORTUGAL                          PORTUGAL%                           %   lfaguiar@eeg.uminho.pt            jsoares@math.uminho.pt %%%%%%%%%%%%%%%%     Tests on inputs and default values    %%%%%%%%%%%%%%%%%if nargin<1, error('must input matrix'); endmat(any(isnan(mat)'),:) = []; % To delete empty spaces, etc[n_rows,n_cols]=size(mat);% Default parametersif (nargin<2 || isempty(dt) || dt==0),  dt = 1; endif (nargin<3 || isempty(dj) || dj==0),  dj = 1./4; endif (nargin<4 || isempty(low_period) || low_period==0), low_period = 2*dt; endif (nargin<5 || isempty(up_period)|| up_period==0), up_period = n_rows*dt; endif (nargin<6|| isempty(pad)), pad = 0; end                                                                                     if (nargin<7 || isempty(mother)), mother = 0; endif (nargin<8 || isempty(beta)), beta = 0; endif (nargin<9  ||  isempty(gamma) ||gamma==0) , gamma = 3.0; end%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%spectra=cell(1,n_cols); % Cell to accomodate the spectrafor iCol=1:n_cols    x=mat(:,iCol); % Select column     % Compute Wavelet Transform of selected column with AWT function     wave=AWT(x,dt,dj,low_period,up_period,pad,mother,beta,gamma);    % Save WT of selected column in cell element    spectra{iCol}=wave; end%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%end